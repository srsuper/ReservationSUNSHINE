<!DOCTYPE html>
<html>
<title>Softway 24hr-Booking</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">


<!------------------------------Script-------------------------------------------------------->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<!-- Line LIFF ------------------>
<script src="https://d.line-scdn.net/liff/1.0/sdk.js"></script>
<!-- Bootstrap core JavaScript and jquery-->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<!--å½±éŸ¿ Close < > çš„åˆ‡æ›icon-->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<!--å¼•ç”¨pluginçš„css(è‡ªè¡Œåˆ°ä½œè€…GitHubä¸‹è¼‰)-->
<link rel="stylesheet" href="css/bootstrap-material-datetimepicker.css" />
<!-- Datepicker ----------------->
<script src="https://use.fontawesome.com/releases/v5.0.9/js/all.js"></script>
<script src="https://use.fontawesome.com/releases/v5.0.9/js/v4-shims.js"></script>
<!--  å¼•ç”¨jQuery------------------>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
<!--æ­¤pluginæœƒå½±éŸ¿èªç³»-------------->
<script type="text/javascript" src="https://momentjs.com/downloads/moment-with-locales.js"></script>
<!--å¼•ç”¨pluginçš„js----------------->
<script src="js/bootstrap-material-datetimepicker.js"></script>



<style type="text/css">
        .dtp-buttons > button.btn {
            border: none;
            border-radius: 15px;
            position: relative;
            box-shadow: none;
            color: rgba(0,0,0, 0.87);
            padding: 5px 40px;
            font-size: 20px;
            margin: 5px 5px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0;
            will-change: box-shadow, transform;
            transition: box-shadow 0.2s cubic-bezier(0.4, 0, 1, 1), background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1), color 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            outline: 0;
            cursor: pointer;
            text-decoration: none;
            background: transparent;
        }
            .dtp-buttons > button.btn:hover,
            .dtp-buttons > button.btn:focus {
                background-color: rgba(153, 153, 153, 0.2);
            }

            /*æˆ‘è‡ªå·±å¤šå¯«é€™å€‹*/
         .dtp-picker-calendar > table {
            width: 100%;
        }
body,h1 {font-family: "Raleway", sans-serif}
body, html {height: 100%}


</style>


<body>
<!-- profile -->
<div class="w3-center w3-animate-top w3-padding-small">
        <img id="img" src="https://upload.wikimedia.org/wikipedia/commons/3/3a/Cat03.jpg" class="w3-circle" style="width:115px">
        <p style="font-size:135%;"><b id="displayname"></b></p><hr>
        <input id="userid" style="display: none" value="">
    </div>

<!-- Phone -->
<div  id="memberphone" class="w3-display-container w3-text-white w3-padding"  >
<div id="form1" class="w3-container w3-white w3-animate-top w3-padding-small">
    <font size="4">
    <label><b>ç¶å®šæ‰‹æ©Ÿ</b></label>
    <input id="phone" class="w3-input w3-border w3-round-large" type="tel" placeholder="E.g. : 0900123456"  autocomplete="off" pattern="[0]{1}[9]{1}[0-9]{8}" required>
    </font>

    <font size="3">
    <input type='checkbox' id="privacy_policy" class="w3-check" style="min-height:20px;min-width:20px;" checked>
    <label>æˆ‘å·²é–±è®€ä¸¦åŒæ„<a href="https://i.imgur.com/AZrtk03.jpg" target="_blank" title="Softwayéš±ç§æ¬Šæ¢æ¬¾"> Softwayéš±ç§æ¬Šæ¢æ¬¾</a></label></p>

    </font>

    <font size='4'>
    <button name="phone_button" class="w3-btn w3-round-large w3-block w3-teal w3-padding-16 w3-section w3-right" onclick="nextClick_2()" disabled='disabled'> ä¸‹ä¸€æ­¥ <span class="glyphicon glyphicon-chevron-right"></span> </button>
    </font>

  </div>
</div>



<!-- Time -->
<div id="time" class="w3-display-container w3-text-white w3-padding" style="display: none">
<div class="w3-container w3-white w3-animate-right w3-padding-small">
<br>
    <font size="4">
        <label><i class="fa fa-calendar"></i> æ—¥æœŸ</label>
            <input class="w3-input w3-border w3-round-large" id="date" type="text" value="" placeholder="è«‹é¸æ“‡æ—¥æœŸ" required>
        </font>
    <br>


    <div class="w3-center w3-bar">
        <input id="session" style="display: none" value="">
        <button type ="button" id="noonTime" name="session" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="noonClick('timeForm_1','timeForm_2', 'noonTime', 'nightTime')" value="noon" disabled>ä¸­åˆæ™‚æ®µ</button>
        <button type ="button" id="nightTime" name="session" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="nightClick('timeForm_1','timeForm_2', 'noonTime', 'nightTime')" value="night" disabled>æ™šä¸Šæ™‚æ®µ</button>
    </div>

<hr>
    <!----æ—©ä¸Šæ™‚æ®µ----->
    <div style="display:none" id="timeForm_1" >
    <div id="start" class="w3-center w3-bar" >
        <p id="noon_num"></p><br>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="11">11:00</button>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="11.5">11:30</button>
        <br>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="12">12:00</button>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="12.5">12:30</button>
        <br>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="13">13:00</button>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="13.5">13:30</button>
    </div>
    </div>

    <!----æ™šä¸Šæ™‚æ®µ----->
    <div style="display:none" id="timeForm_2" >
    <div id="start" class="w3-center w3-bar">
        <p id="night_num"></p><br>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="17">17:00</button>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="17.5">17:30</button>
        <br>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="18">18:00</button>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="18.5">18:30</button>
        <br>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="19">19:00</button>
        <button type ="button" name="startTime" class="w3-btn w3-border w3-round-large w3-xlarge" onClick="timeClick(this)" value="19.5">19:30</button>
    </div>
    </div>



    <font size='4'>
    <button id="next" class="w3-btn w3-round-large w3-block w3-teal w3-padding-16 w3-section w3-right" onclick="nextClick_1()" disabled>ä¸‹ä¸€æ­¥ <span class="glyphicon glyphicon-chevron-right"></span></button>
    </font>
    </div>


    </div>



<!-- Number & Price % Ps-->
<div id="member" class="w3-display-container w3-text-white w3-padding" style="display: none">
<input id="store_name" value="ç¸½åº—" style="display: none">
<div class="w3-container w3-white w3-animate-right w3-padding-small">

        <font size="4">
        <label><i class="fa fa-male"></i> æˆäºº</label>
            <select class="select form-control" type="number" value="" id="adult" required>
                <option value="" disabled selected>è«‹é¸æ“‡äººæ•¸</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
            </select>
            </font>
 <br>
        <font size="4">
        <label><i class="fa fa-child"></i> å…’ç«¥</label>
          <select class="select form-control" type="number" value="" id="children" required>
          <option value="" disabled selected>è«‹é¸æ“‡äººæ•¸</option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            </select>
        </font>
<br>
        <font size="4">
        <label><i class="fa fa-usd"></i> åƒ¹ä½/æ¯äºº</label>
            <br>
            <input id="price" style="display: none" value="" required>
            <input type="button" name="price" class="w3-btn w3-border w3-round-large w3-normal" value="$500" onclick="priceClick(this)">
            <input type="button" name="price" class="w3-btn w3-border w3-round-large w3-normal" value="$600" onclick="priceClick(this)">
            <input type="button" name="price" class="w3-btn w3-border w3-round-large w3-normal" value="$800" onclick="priceClick(this)">
            <input type="button" name="price" class="w3-btn w3-border w3-round-large w3-normal" value="$1000" onclick="priceClick(this)">
            <input type="button" name="price" class="w3-btn w3-border w3-round-large w3-normal" value="$1200" onclick="priceClick(this)">

        </font>

        <div class="w3-section">
              <font size="3.5">
              <label><i class="fa fa-bell"></i> é£²é£Ÿç¿’æ…£</label>
                <br>
                  <input id="ps" style="display: none" value="">
                  <button type="button" class="w3-btn w3-border w3-round-large w3-normal" value="#ä¸åƒç‰›" onclick="psClick(this)">ä¸åƒç‰›</button>
                  <button type="button" class="w3-btn w3-border w3-round-large w3-normal" value="#ä¸åƒæµ·é®®" onclick="psClick(this)">ä¸åƒæµ·é®®</button>
                <br>
                  <button type="button" class="w3-btn w3-border w3-round-large w3-normal" value="#è›‹å¥¶ç´ " onclick="psClick(this)">è›‹å¥¶ç´ </button>
                  <button type="button" class="w3-btn w3-border w3-round-large w3-normal" value="#è”¬é£Ÿ(ç„¡è‚‰)" onclick="psClick(this)">è”¬é£Ÿ(ç„¡è‚‰)</button>
                  <button type="button" class="w3-btn w3-border w3-round-large w3-normal" value="#å…¨ç´ (ç„¡è¾›æ–™)" onclick="psClick(this)">å…¨ç´ </button>
                <br><br>
                ç‰¹æ®Šé£²é£Ÿç¿’æ…£<input id="otherps" type="text" class="w3-input w3-border w3-round-large" value="">
              </font>
          </div>

    </div>
    <font size='4'>
    <button id="previous" class="w3-btn w3-round-large w3-block w3-dark-grey w3-padding w3-right" onclick="prevClick()"><span class="glyphicon glyphicon-chevron-left"></span> ä¸Šä¸€é </button>
    <button type="submit" id="sendbook" class="w3-btn w3-round-large w3-block w3-teal w3-padding-16 w3-section w3-right">å®Œæˆ <span class="glyphicon glyphicon-ok"></span></button>
    </font>

    </div>

<!--script function -->
<script>
function priceClick(x){
    var k = document.getElementsByName("price")
        for (i = 0; i < k.length; i++){
            k[i].classList.remove("w3-teal")
        }
    if(x.classList.contains("w3-teal") == false){
        x.classList.add('w3-teal');
        document.getElementById('price').value = x.value;
    }else{
        x.classList.remove("w3-teal");
        document.getElementById('price').value = "";
    }
}

function noonClick(id_1,id_2,id_3,id_4) {
  var x = document.getElementById(id_1);
  var y = document.getElementById(id_2);
  var a = document.getElementById(id_3);
  var b = document.getElementById(id_4);
  document.getElementById('noon_num').innerHTML='è®€å–ä¸­...';

  if (x.classList.contains("w3-show") == false) {
    x.classList.add("w3-show");
    y.classList.remove("w3-show");
    a.innerHTML = "âœ“ä¸­åˆæ™‚æ®µ"
    b.innerHTML = "æ™šä¸Šæ™‚æ®µ"
    a.classList.add("w3-teal")
    b.classList.remove("w3-teal");
    document.getElementById('session').value = 'noon';
    var noon='noon';
    var booking_date = $('#date').val();
    data={
      'time_session':noon,
      'booking_date':booking_date,
      'action':'querying_num'
    }
    query_people(data);
  }

}

function nightClick(id_1,id_2,id_3,id_4) {
  var x = document.getElementById(id_1);
  var y = document.getElementById(id_2);
  var a = document.getElementById(id_3);
  var b = document.getElementById(id_4);
  document.getElementById('night_num').innerHTML='è®€å–ä¸­...';

  if (y.classList.contains("w3-show") == false) {
    y.classList.add("w3-show");
    x.classList.remove("w3-show");
    b.innerHTML = "âœ“æ™šä¸Šæ™‚æ®µ"
    a.innerHTML = "ä¸­åˆæ™‚æ®µ"
    b.classList.add("w3-teal")
    a.classList.remove("w3-teal");
    document.getElementById('session').value = 'night';
    var night='night';
    var booking_date = $('#date').val();
    data={
      'time_session':night,
      'booking_date':booking_date,
      'action':'querying_num'
    }
    query_people(data);

  }
}

function timeClick(x){
    var k = document.getElementsByName("startTime")
        for (i = 0; i < k.length; i++){
            k[i].classList.remove("w3-teal")
        }
    if(x.classList.contains("w3-teal") == false){
        x.classList.add('w3-teal');
        document.getElementById('start').value = x.value;
    }else{
        x.classList.remove("w3-teal");
        document.getElementById('start').value = "";
    }
}

function psClick(x){
    var p = document.getElementById("ps")

    if(x.classList.contains("w3-teal") == false){
        x.classList.add("w3-teal")
        p.value += x.value
    }else{
         x.classList.remove("w3-teal")
         p.value -= x.val
         if(isNaN(p.value)){
             p.value = ''
         }
    }

}

function nextClick_1(){
    document.getElementById('time').style.display='none';
    document.getElementById('member').style.display='block';
}

function nextClick_2(){
    document.getElementById('memberphone').style.display='none';
    document.getElementById('time').style.display='block'
}

function prevClick(){
  document.getElementById('member').style.display='none';
  document.getElementById('time').style.display='block';
}
</script>


<!--datetimepicker of parameter--->
<script type="text/javascript">
  $(function () {
    $('#date').bootstrapMaterialDatePicker(
        {
            time: false, nowButton:false, clearButton: false, okText: 'ç¢ºèª', cancelText: 'å–æ¶ˆ', minDate: moment() ,maxDate: moment().add(14,'day'), disabledDays: [1], format: 'YYYY/MM/DD dddd'
        });
    });
</script>


<!-- script  Line jquery-->
<script>
    function initializeApp(data) {
            liff.getProfile().then(profile =>
                {
                    var disname = {'name' : profile.displayName};
                    disname_json = JSON.parse(JSON.stringify(disname.name))
                    $('#userid').val(profile.userId);
                    $('#img').attr('src',profile.pictureUrl);
                    $('#displayname').html(profile.displayName);

                }
            )
        }
    //ready
    $(function () {
        //init LIFF
        liff.init(function(data) {
            initializeApp(data);
        });
        //ButtonSendMsg
            $('#sendbook').click(function () {
                var start = parseFloat($("#start").val());

                if (start-parseInt($("#start").val()) === 0){
                     start =  $("#start").val() + ":00";
                  }
                else{
                     start =  parseInt($("#start").val()).toString() +':'+ ((start-parseInt($("#start").val()))*60).toString();
                  }

                if($('#male').is(':checked')){
                    var gender = 'å…ˆç”Ÿ';
                }
                else{
                    var gender = 'å°å§';
                }
                if($('#ps').val() + $('#otherps').val() == ""){
                    var ps = "ç„¡";
                }
                else{
                    var ps = $('#ps').val() + $('#otherps').val()
                }

                liff.sendMessages([
                 {
                  "type": "flex",
                  "altText": "Flex Message",
                  "contents": {
                    "type": "bubble",
                    "body": {
                      "type": "box",
                      "layout": "vertical",
                      "contents": [
                        {
                          "type": "text",
                          "text": "ğŸ‘¤ "+ disname_json +" é ç´„æˆåŠŸ",
                          "size": "xl",
                          "weight": "bold"
                        },
                        {
                          "type": "box",
                          "layout": "vertical",
                          "spacing": "sm",
                          "margin": "lg",
                          "contents": [
                            {
                              "type": "box",
                              "layout": "baseline",
                              "spacing": "sm",
                              "contents": [
                                {
                                  "type": "text",
                                  "text": "é ç´„",
                                  "flex": 1,
                                  "size": "sm",
                                  "color": "#AAAAAA"
                                },
                                {
                                  "type": "text",
                                  "text": disname_json + " " +$('#adult').val() + "å¤§"+ $('#children').val() + "å°",
                                  "flex": 5,
                                  "size": "sm",
                                  "color": "#666666",
                                  "wrap": true
                                }
                              ]
                            },
                            {
                              "type": "box",
                              "layout": "baseline",
                              "spacing": "sm",
                              "contents": [
                                {
                                  "type": "text",
                                  "text": "é›»è©±",
                                  "flex": 1,
                                  "size": "sm",
                                  "color": "#AAAAAA"
                                },
                                {
                                  "type": "text",
                                  "text": $('#phone').val(),
                                  "flex": 5,
                                  "size": "sm",
                                  "color": "#666666",
                                  "wrap": true
                                }
                              ]
                            },
                            {
                              "type": "box",
                              "layout": "baseline",
                              "spacing": "sm",
                              "contents": [
                                {
                                  "type": "text",
                                  "text": "æ™‚é–“",
                                  "flex": 1,
                                  "size": "sm",
                                  "color": "#AAAAAA"
                                },
                                {
                                  "type": "text",
                                  "text": $("#date").val() +" â± "+ start ,
                                  "flex": 5,
                                  "size": "sm",
                                  "color": "#666666",
                                  "wrap": true
                                }
                              ]
                            },
                            {
                              "type": "box",
                              "layout": "baseline",
                              "spacing": "sm",
                              "contents": [
                                {
                                  "type": "text",
                                  "text": "å‚™è¨»",
                                  "flex": 1,
                                  "size": "sm",
                                  "color": "#AAAAAA"
                                },
                                {
                                  "type": "text",
                                  "text": ps,
                                  "flex": 5,
                                  "size": "sm",
                                  "color": "#666666",
                                  "wrap": true
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    "footer": {
                    "type": "box",
                    "layout": "vertical",
                    "flex": 0,
                    "spacing": "sm",
                    "contents": [
                      {
                        "type": "button",
                        "action": {
                          "type": "uri",
                          "label": "è®Šæ›´/å–æ¶ˆè¨‚ä½",
                          "uri": "line://app/1577114898-D5d8edOv"
                        },
                        "color": "#2C9278",
                        "height": "sm",
                        "style": "primary"
                      }
                    ]
                  }
                }
              }
                ])
               .then(() => {
                   setTimeout(function(){}, 1000);
                   liff.closeWindow();
               })
               .catch((err) => {
                    // console.log('error', err);
               });
            });

    })
    </script>



<!--script jquery -->
<script>
    $(document).ready(function(){
      //if phonenumber is not correct, then show the alert message and clean phone value.
      $('#phone').change(function(){
        var phone = $('#phone').val();
        var reg_phone = new RegExp(/^09\d{8}$/);
        if(reg_phone.test(phone) == false){
          alert('æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼ä¸æ­£ç¢º!!');
          $('#phone').val('');
          $("button[name='phone_button']").attr("disabled",true);
        }
        else if($('#privacy_policy').is(':checked') && phone != ''){
          $("button[name='phone_button']").attr("disabled",false);
        }
      });
      //if privacy_policy checkbox is checked, then phone_button of attribution will be disabled.
      $('#privacy_policy').click(function(){
        var phone = $('#phone').val();
        var reg_phone = new RegExp(/^09\d{8}$/);
        if($('#privacy_policy').is(':checked') && phone != ''){
          $("button[name='phone_button']").attr("disabled",false);
        }
        else if($('#privacy_policy').is(':checked') == false || phone == ''){
          $("button[name='phone_button']").attr("disabled",true);
        }
      });
      //if date is not null, then the session button of attribution disabled will be removed.
      $("#date").change(function(){
        $("button[name='session']").removeAttr('disabled')
      });

      //if startTime button be clicked, then the next button of disabled attribution will be removed.
      $("button[name='startTime']").click(function(){
        $("#next").removeAttr('disabled')
      })

    });

    $(function () {
      $('#sendbook').click(function (e) {
        var status = true;
        var action = 'booking';
        // å§“å
        var name = disname_json;
        // é›»è©±
        var phone = $('#phone').val();
        // åº—å®¶
        var store = $('#store_name').val();
        // äººæ•¸
        var adult = $('#adult').val();
        var children = $('#children').val();
        //gender
        var gender = 'M';
        // è¨‚ä½æ—¥æœŸ
        var booking_date = $('#date').val();
        // è¨‚ä½é–‹å§‹
        var booking_start = $('#start').val();
        // é›»è©±(é™¤éŒ¯)
        var reg_phone = new RegExp(/^09\d{8}$/);
        var userid = $('#userid').val();
        var time_session = $('#session').val();
        var price = $('#price').val();


        var ps = $('#ps').val() + $('#otherps').val();

        // if ($('#male').is(':checked')){
        //   var gender = $('#male').val();
        // }
        // else {
        //   var gender = $('#female').val();
        // }

        if (adult == '') {
          $('#adult').css('border', '1px solid #ff0000');
          alert('è«‹é¸æ“‡æˆäººè¨‚ä½çš„äººæ•¸å–”');
          status = false;
        }
        else if (children == '') {
          $('#children').css('border', '1px solid #ff0000');
          alert('è«‹é¸æ“‡å°å­©è¨‚ä½çš„äººæ•¸å–”');
          status = false;
        }
        else if (phone == '') {
          $('#phone').css('border', '1px solid #ff0000');
          alert('è«‹è¼¸å…¥é›»è©±è™Ÿç¢¼');
          status = false;
        }
        else if (reg_phone.test(phone) ==false){
          $('#phone').css('border', '1px solid #ff0000');
          alert('æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼ä¸æ­£ç¢º!!');
          status = false;
        }
        // if (store == '') {
        //   $('#store_name').css('border', '1px solid #ff0000');
        //   alert('è«‹é¸æ“‡è¨‚ä½çš„åº—å®¶å–”');
        //   status = false;
        // }
        // else if (booking_date == '') {
        //   $('#date').css('border', '1px solid #ff0000');
        //   status = false;
        //   alert('è«‹é¸æ“‡è¨‚ä½çš„æ—¥æœŸ');
        // }
        // else if (name == '') {
        //   alert('è«‹è¼¸å…¥å§“å');
        //   $('#name').css('border', '1px solid #ff0000');
        //   status = false;
        // }
        //else if(parseInt(adult)+parseInt(children)==0){
          //$('#children').css('border', '1px solid #ff0000');
          //$('#adult').css('border', '1px solid #ff0000');
          //alert('æˆäººå’Œå°å­©ç¸½æ•¸ä¸å¯ä»¥ç­‰æ–¼0');
          //status = false;
        //}
        // else if (booking_start == '') {
        //   status = false;
        //   alert('è«‹é¸æ“‡ç”¨é¤é–‹å§‹æ™‚é–“')
        // }

        if (status) {

          var data = {
            'userid': userid,
            'username': name,
            'gender': gender,
            'phone': phone,
            'booking_date': booking_date,
            'booking_start_time': booking_start,
            'time_session': time_session,
            'store': store,
            'adult': adult,
            'children': children,
            'price': price,
            'ps': ps,
            'action': action,
          }

          $("#sendbook").attr("disabled", true);
          // å‘¼å« send ajax function
          send(data);
        }

      });
    });

    function query_people(data){
      $.ajax({
        type: "get",
        url:"https://script.google.com/macros/s/AKfycbz4QU7y1coY0DPM8sBFumKxKabm7xOVtIxE0Lzt4IMz-qTmH6w/exec",
        data:data,
        success:function(response){
          var number = parseInt(response.result);
          var time_session = response.time_session;
          if (number >=20){
            if(time_session=='noon'){

              document.getElementById('noon_num').innerHTML=('å·²é¡æ»¿');
            }
            else{
              document.getElementById('night_num').innerHTML=('å·²é¡æ»¿');
            }
          }
          else{
              if(time_session=='noon'){

                document.getElementById('noon_num').innerHTML=('å‰©é¤˜'+(20-number)+'äºº');
              }
            else{
              document.getElementById('night_num').innerHTML=('å‰©é¤˜'+(20-number)+'äºº');
            }
          }


        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {

          alert('è©²æ™‚æ®µå‰©é¤˜äººæ•¸å–å¾—å¤±æ•—ï¼Œè«‹é‡æ–°é»æ“Šï¼');
        }
      })
    }

    function send(data) {
      $.ajax({
        type: "get",
        url: "https://script.google.com/macros/s/AKfycbz4QU7y1coY0DPM8sBFumKxKabm7xOVtIxE0Lzt4IMz-qTmH6w/exec",
        data: data,
        success: function (response) {
          if (response.result == 'error') {
            $("#sendbook").attr("disabled", false);
          }
          else if (response.result == 'full'){
            bk_st=parseFloat(data.booking_start_time)*60
            if (bk_st %60 != 0){
                    bk_st = parseInt(bk_st/60).toString()+':'+(bk_st%60).toString()
                }
            else{
                    bk_st = (bk_st/60).toString()+':00'
                }

            $("#sendbook").attr("disabled", false);
            $('#start').val('');
            alert('å¾ˆæŠ±æ­‰ï¼ï¼'+bk_st+" è‡³ "+" è¨‚ä½å·²æ»¿ï¼Œè«‹é¸æ“‡å…¶ä»–æ™‚æ®µ")
          }
          else {
            $("#sendbook").attr("disabled", false);
            $('#name').val('');
            $('#phone').val('');
            $('#store_name').val('');
            $('#adult').val('');
            $('#children').val('');
            $('#start').val('');
            alert('æ„Ÿè¬æ‚¨çš„è¨‚ä½!!');
          }

        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {

          $("#sendbook").attr("disabled", false);
          $('#name').val('');
          $('#phone').val('');
          $('#store_name').val('');
          $('#adult').val('');
          $('#children').val('');
          $('#start').val('');
          alert('å¾ˆæŠ±æ­‰ï¼Œè¨‚ä½å¤±æ•— !!')
        }
      });
    }
    </script>

</body>
</html>
